(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-133ef221"],{"6bd9":function(e,t,n){"use strict";var a=function(){var e=this,t=e._self._c;return t("table",{staticClass:"wbs-form-table mt"},[t("tbody",[t("tr",[t("th",{staticClass:"row w8em"}),t("td",[t("el-button",{attrs:{size:"medium",type:"primary",plain:"",icon:"el-icon-collection"},on:{click:function(t){e.unfold=!e.unfold}}},[e._v("变量注释")]),t("table",{directives:[{name:"show",rawName:"v-show",value:e.unfold,expression:"unfold"}],staticClass:"wbs-table wbs-table-doc table-hover mt"},[e._m(0),t("tbody",e._l(e.doc_items,(function(n){return t("tr",{key:n.name},[t("td",[t("b",[e._v(e._s(n.name))])]),t("td",{domProps:{innerHTML:e._s(n.desc)}})])})),0)])],1)])])])},i=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("td",[e._v("变量名称")]),t("td",[e._v("变量说明")])])])}],s={name:"comVariableDoc",props:{type:{type:String,value:""}},data(){return{doc_items:[],unfold:!1}},created(){const e=this,t="WB_SST_DOC"+(e.type?"_"+e.type:"");let n=localStorage.getItem(t);n=n?JSON.parse(n):null,n&&n.ver==e.$cnf.pd_version?e.doc_items=n.data:e.$api.getData({action:e.$cnf.action.act,op:"doc",type:e.type?e.type:""}).then(n=>{e.doc_items=n["data"],localStorage.setItem(t,JSON.stringify({ver:e.$cnf.pd_version,data:n["data"]}))})}},o=s,c=n("2877"),l=Object(c["a"])(o,a,i,!1,null,null,null);t["a"]=l.exports},"9cda":function(e,t,n){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{ref:"wp",staticClass:"wbs-tag-format"},[e.cnf.variableOnly?e._e():t("span",{staticClass:"el-dropdown-link",on:{click:function(t){return t.stopPropagation(),e.inset_item()}}},[t("i",{staticClass:"el-icon-circle-plus el-icon--right"}),t("span",{staticClass:"label-inset-var"},[e._v("插入变量")])]),t("div",{staticClass:"input-box",class:{"is-focus":e.isFocus}},[e.cnf.variableOnly?t("div",[e._l(e.item_list,(function(n,a){return t("tag-variable-item",{key:a,ref:"tagItem",refInFor:!0,attrs:{opt:n,cnf:e.cnf},on:{del:function(t){return e.del_item(a,t)}}})})),t("span",{staticClass:"input-item-btn",on:{click:function(t){return t.stopPropagation(),e.inset_tag()}}},[t("i",{staticClass:"el-icon-circle-plus el-icon--right"}),t("span",{staticClass:"label-inset-var"},[e._v("插入变量")])])],2):t("div",e._l(e.item_list,(function(n,a){return t("tag-item",{key:a,ref:"tagItem",refInFor:!0,class:{"last-item":a==e.items.length-1},attrs:{opt:n,cnf:e.cnf},on:{focus:function(t){return e.get_focus(a)},blur:e.blur_handler,change:function(t){return e.tag_change(a,t)},add:function(t){return e.inset_item(a)},del:function(t){return e.del_item(a,t)},"active-next":function(t){return e.active_next(a,t)}}})})),1),t("ul",{directives:[{name:"show",rawName:"v-show",value:e.dropdown_active,expression:"dropdown_active"}],ref:"dropdownList",staticClass:"el-dropdown-menu el-popper"},e._l(e.cnf.dropdownItems,(function(n,a){return t("li",{key:a,staticClass:"el-dropdown-menu__item",on:{click:function(t){return e.select_dropdown_value(n,a)}}},[e._v(" "+e._s(n)+" ")])})),0),e.cnf.variableOnly?e._e():t("div",{staticClass:"inner-mask",on:{click:e.focus_wp}})])])},i=[],s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ib input-item",class:e.locked?"tag-ib":"",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.del_tag_ib.apply(null,arguments)},input:e.tag_wp_input,click:function(t){return t.stopPropagation(),e.$emit("focus")}}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.locked,expression:"locked"}],ref:"displayValue",staticClass:"display-value",on:{click:e.select}},[e._v(e._s(e.opt.name))]),t("i",{staticClass:"del",on:{click:e.del_tag_ib}}),e.locked?e._e():t("span",{staticClass:"between-tag-input",attrs:{contenteditable:"true"},domProps:{innerHTML:e._s(e.opt.value)},on:{blur:function(t){return e.input_action(t)},focus:function(t){return e.$emit("focus")},input:function(t){return e.div_input(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.div_keydown(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.div_enter(t)}}})])},o=[],c={name:"comTagItem",props:{opt:""},data(){const e=this;return{tag_ib_html:"",value:e.opt.value,del_action:0}},created(){},mounted(){const e=this;e.tag_ib_html=e.$refs.displayValue.outerHTML},methods:{input_action(e){const t=this,n=e.target.innerText;t.opt.value=n,t.$emit("change",{name:n,value:n,type:0}),t.$emit("blur",n)},div_keydown(e){const t=this;let n=t.value;""===n&&(t.del_action>0?(t.$emit("del",-1),t.del_action=0):(t.del_action++,t.$emit("change",{name:"",value:"",type:0})))},div_enter(e){return e.preventDefault(),!1},div_input(e){const t=this,n=e.target.innerText;if("%"==n)return t.$emit("add",!0),!1;n.replace(/%/,"&#x25;"),t.value=e.target.innerText},tag_wp_input(e){const t=this;t.locked&&(e.target.innerHTML=t.tag_ib_html,t.$emit("active-next",e.data))},select(e){const t=window.getSelection(),n=document.createRange();t.removeAllRanges(),n.selectNodeContents(e.currentTarget),t.addRange(n)},del_tag_ib(e){this.$emit("del",0)}},computed:{locked(){return this.opt.type}}},l=c,r=n("2877"),d=Object(r["a"])(l,s,o,!1,null,null,null),u=d.exports,p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ib tag-item",class:e.locked?"tag-ib":"",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.del_tag_ib.apply(null,arguments)},input:e.tag_wp_input,click:function(t){return t.stopPropagation(),e.$emit("focus")}}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.locked,expression:"locked"}],ref:"displayValue",staticClass:"display-value",on:{click:e.select}},[e._v(e._s(e.opt.name))]),t("i",{staticClass:"del",on:{click:e.del_tag_ib}}),e.locked?e._e():t("span",{staticClass:"between-tag-readonly",domProps:{innerHTML:e._s(e.opt.value)},on:{blur:function(t){return e.input_action(t)},focus:function(t){return e.$emit("focus")},input:function(t){return e.div_input(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.div_keydown(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.div_enter(t)}}})])},_=[],m={name:"comTagItemVariableOnly",props:{opt:""},data(){const e=this;return{tag_ib_html:"",value:e.opt.value,del_action:0}},created(){},mounted(){const e=this;e.tag_ib_html=e.$refs.displayValue.outerHTML},methods:{input_action(e){const t=this,n=e.target.innerText;t.opt.value=n,t.$emit("change",{name:n,value:n,type:0}),t.$emit("blur",n)},div_keydown(e){const t=this;let n=t.value;""===n&&(t.del_action>0?(t.$emit("del",-1),t.del_action=0):(t.del_action++,t.$emit("change",{name:"",value:"",type:0})))},div_enter(e){return e.preventDefault(),!1},div_input(e){const t=this,n=e.target.innerText;if("%"==n)return t.$emit("add",!0),!1;n.replace(/%/,"&#x25;"),t.value=e.target.innerText},tag_wp_input(e){const t=this;t.locked&&(e.target.innerHTML=t.tag_ib_html,t.$emit("active-next",e.data))},select(e){const t=window.getSelection(),n=document.createRange();t.removeAllRanges(),n.selectNodeContents(e.currentTarget),t.addRange(n)},del_tag_ib(e){this.$emit("del",0)}},computed:{locked(){return this.opt.type}}},v=m,f=Object(r["a"])(v,p,_,!1,null,null,null),g=f.exports,h={name:"WBTagFormat",props:{opt:String,cnf:{type:Object,value:{dropdownItems:{},variableOnly:!1}}},components:{"tag-item":u,"tag-variable-item":g},data(){const e=this;let t;return t=e.cnf.variableOnly?e.opt.replace(/,/g,""):e.opt,{empty_item:{name:"",value:"",type:0},cur_value:t,cur_index:0,had_add:0,dropdown_active:0,isFocus:0,cnf_keys:Object.keys(e.cnf.dropdownItems),item_list:[]}},created(){},mounted(){const e=this;e.$nextTick(()=>{e.cur_index=e.item_list.length-1}),document.addEventListener("click",(function(t){e.dropdown_active&&e.hide_dropdown()}))},methods:{tag_change(e,t){const n=this;let a=n.items,i="";null!=t&&(a[e]=t.value,a.forEach((function(e,t,n){e&&(i+=e)})),n.cur_value=i)},inset_item(e){const t=this;let n=null!=e?e:t.cur_index;""!==t.item_list[n].value&&(n+=1,t.items.splice(n,0,"%"),t.item_list.splice(n,0,t.empty_item),t.cur_index=n),t.item_list[n].value="%",t.active_dropdown(n)},inset_tag(e){const t=this;let n=null!=e?e:t.cur_index;t.item_list[n].value="",t.active_dropdown(n)},del_item(e,t){const n=this;let a="",i=n.items,s=e+t;s=s>=0?s:0,n.item_list[s].type&&(i.forEach((function(e,t){s!==t&&(a+=e)})),n.cur_value=a,n.cur_index=s-1,n.set_focus(s))},active_dropdown(e){const t=this,n=null!==e?e:t.cur_index,a=t.$refs.tagItem.length-1;let i=n>a?a:n;const s=t.$refs.tagItem[i].$el.offsetLeft;t.dropdown_active=!0,t.$refs.dropdownList.style.left=s+"px",t.$refs.wp.classList.add("active-dropdown")},hide_dropdown(){const e=this;e.dropdown_active=!1,e.$refs.dropdownList.style.left="",e.$refs.wp.classList.remove("active-dropdown")},select_dropdown_value(e,t){const n=this;let a="",i=n.items,s=n.cur_index;i[s]=t,i.forEach((function(e,t){a+=e})),n.cur_value=a,n.hide_dropdown(),n.$nextTick(()=>{const e=n.items.length;n.cur_index=e-1,n.set_focus(e)})},active_next(e,t){const n=this,a=e+1,i=n.$refs.tagItem[a].$el.querySelector(".between-tag-input"),s=i.innerText;i.innerText=t+s,i.focus();const o=window.getSelection();o.removeAllRanges();const c=document.createRange();c.setStart(i,1),o.addRange(c)},set_focus(e){const t=this,n=e>1?e-1:0,a=t.$refs.tagItem[n].$el,i=a.querySelector(".between-tag-input"),s=window.getSelection(),o=document.createRange();if(i){let e=i.innerText.length;const t=e?i.firstChild:i;s.removeAllRanges(),o.setStart(t,e),o.setEnd(t,e)}else{const e=a.querySelector(".display-value");s.removeAllRanges(),e&&o.selectNode(e)}return s.addRange(o),!1},get_focus(e){this.cur_index=e,this.isFocus=!0},focus_wp(){const e=this,t=e.$refs.tagItem.length;e.cur_index=t-1,e.set_focus(t),e.isFocus=!0},blur_handler(e){const t=this;t.isFocus=!1}},computed:{items(){const e=this;let t=e.cur_value;return t?(e.cnf.variableOnly&&(t=t.replace(/,/g,"")),t=t.replace(/(%\w+%)/g,"##$1##"),t=t.replace(/^##/g,""),t.split("##")):[]}},watch:{cur_value:{handler(e){const t=this,n=t.cnf.variableOnly?e.replace(/,/g,""):e;let a=n;a=a.replace(/(%\w+%)/g,"##$1##"),a=a.replace(/^##/g,"");const i=[{name:"",value:"",type:0}],s=n?a.split("##"):[];s.forEach((function(e,n){const a=t.cnf_keys.indexOf(e)>-1?1:0;i[n]={name:a?t.cnf.dropdownItems[e]:e,value:e,type:a}})),i.slice(-1)[0].type&&i.push(t.empty_item),t.item_list=i,t.$emit("change",n)},immediate:!0},opt:{handler(e){const t=this;t.cur_value=e}}}},w=h,b=Object(r["a"])(w,a,i,!1,null,null,null);t["a"]=b.exports},feec:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wbs-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":e.isLoaded}},[t("div",{staticClass:"wbs-main"},[t("div",{staticClass:"opt-function-hd"},[e._m(0),t("div",{staticClass:"func-desc"},[e._v(" 根据规则自动生成图片Title和ALT替代文本。 ")]),t("div",{staticClass:"mt"},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.opt.active,callback:function(t){e.$set(e.opt,"active",t)},expression:"opt.active"}}),e._v(" "),t("span",{staticClass:"ml ib"},[e._v("功能"+e._s("1"==e.opt.active?"开启":"关闭"))])],1)]),e.isLoaded?t("table",{staticClass:"wbs-form-table"},[t("tbody",[t("tr",[t("th",{staticClass:"row w8em",staticStyle:{width:"10em"}},[e._v("应用方式")]),t("td",{staticClass:"info"},[t("el-radio-group",{model:{value:e.opt.mode,callback:function(t){e.$set(e.opt,"mode",t)},expression:"opt.mode"}},e._l(e.cnf.active_type,(function(n){return t("el-radio",{key:n.val,attrs:{label:n.val}},[e._v(e._s(n.label))])})),1)],1)]),t("tr",[t("th",{staticClass:"row"},[e._v("图片ALT&Title")]),t("td",[t("wbs-title-format",{attrs:{cnf:{dropdownItems:e.cnf.img_variables},opt:e.opt.content},on:{change:function(t){e.opt.content=t}}})],1)]),t("tr",[t("th",{staticClass:"row"},[e._v("特色图片ALT&Title")]),t("td",[t("wbs-title-format",{attrs:{cnf:{dropdownItems:e.cnf.img_variables},opt:e.opt.thumb},on:{change:function(t){e.opt.thumb=t}}})],1)])])]):e._e(),t("wbs-var-doc",{directives:[{name:"show",rawName:"v-show",value:e.isLoaded,expression:"isLoaded"}],attrs:{type:"image"}}),t("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:e.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),e.$cnf.is_pro?e._e():t("wbs-more-sources",{directives:[{name:"show",rawName:"v-show",value:e.isLoaded,expression:"isLoaded"}]})],1),t("wbs-ctrl-bar",{on:{submit:e.updateData}})],1)},i=[function(){var e=this,t=e._self._c;return t("h3",{staticClass:"func-name"},[t("strong",[e._v("图片优化")])])}],s=n("9cda"),o=n("6bd9"),c={name:"ImageView",components:{"wbs-title-format":s["a"],"wbs-var-doc":o["a"]},data(){const e=this;return{formChanged:0,isLoaded:!1,is_pro:e.$cnf.is_pro,opt:{},cnf:{}}},created(){const e=this;e.getData()},methods:{getData(){const e=this;e.$api.getData({action:e.$cnf.action.act,op:"get_options",key:"img_seo"}).then(t=>{e.opt=t.data.opt,e.cnf=t.data.cnf,e.isLoaded=!0})},updateData(e){const t=this;t.$api.saveData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:t.$cnf.action.act,op:"update_options",opt:t.opt,key:"img_seo"}).then(n=>{t.$wbui.toast("设置保存成功"),t.formChanged=1,e&&e()})},title_format(e){return e=e.replace(/(%\w+%)/g,",$1,"),e=e.replace(/,,/g,","),e=e.replace(/^,/g,""),e}},watch:{opt:{handler(){this.formChanged++},deep:!0}},beforeRouteLeave(e,t,n){const a=this;a.formChanged>2?a.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return n(!1),a.updateData(()=>{n()}),!1},no(){return n(),!1}}):n()}},l=c,r=n("2877"),d=Object(r["a"])(l,a,i,!1,null,null,null);t["default"]=d.exports}}]);