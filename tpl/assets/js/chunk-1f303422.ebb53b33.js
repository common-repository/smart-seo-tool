(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f303422"],{6485:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[e("div",{staticClass:"wbs-main"},[e("div",{staticClass:"opt-function-hd"},[t._m(0),e("div",{staticClass:"func-desc"},[t._v(" 自动扫描并检测网站页面出站链接，以及早发现并处理失效链接。 ")]),e("div",{staticClass:"mt"},[e("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.active,callback:function(e){t.$set(t.opt,"active",e)},expression:"opt.active"}}),e("span",{staticClass:"ml ib"},[t._v("功能"+t._s("1"==t.opt.active?"开启":"关闭"))])],1)]),t.isLoaded?e("table",{staticClass:"wbs-form-table"},[e("tbody",[e("tr",[e("th",{staticClass:"w8em"},[t._v("检测频率")]),e("td",{staticClass:"info"},[e("el-radio-group",{model:{value:t.opt.test_rate,callback:function(e){t.$set(t.opt,"test_rate",e)},expression:"opt.test_rate"}},t._l(t.cnf.test_rate,(function(a,s){return e("el-radio",{key:a,attrs:{label:s}},[t._v(t._s(a))])})),1)],1)])]),e("tbody",{directives:[{name:"show",rawName:"v-show",value:t.viewAllOption,expression:"viewAllOption"}]},[e("tr",[e("th",[t._v("检测范围")]),e("td",[e("el-tabs",{model:{value:t.tabTypeCctiveName,callback:function(e){t.tabTypeCctiveName=e},expression:"tabTypeCctiveName"}},[e("el-tab-pane",{attrs:{label:"链接类型",name:"url_type"}},[e("el-checkbox-group",{model:{value:t.opt.url_type,callback:function(e){t.$set(t.opt,"url_type",e)},expression:"opt.url_type"}},t._l({out:"站外链接",in:"站内链接"},(function(a,s){return e("el-checkbox",{key:s,attrs:{label:s}},[t._v(t._s(a))])})),1)],1),e("el-tab-pane",{attrs:{label:"文章类型",name:"post_type"}},[e("el-checkbox-group",{model:{value:t.opt.post_type,callback:function(e){t.$set(t.opt,"post_type",e)},expression:"opt.post_type"}},t._l(t.post_types,(function(a,s){return e("el-checkbox",{key:s,attrs:{label:s}},[t._v(t._s(a.name))])})),1)],1),e("el-tab-pane",{attrs:{label:"文章状态",name:"post_status"}},[e("el-checkbox-group",{model:{value:t.opt.post_status,callback:function(e){t.$set(t.opt,"post_status",e)},expression:"opt.post_status"}},t._l(t.post_statuses,(function(a,s){return e("el-checkbox",{key:s,attrs:{label:s}},[t._v(t._s(a.name))])})),1)],1)],1)],1)]),e("tr",[e("th",[t._v("排除域名列表")]),e("td",[e("wbs-custom-links",{attrs:{items:t.opt.exclude,mode:1,placeholder:"例如：yourdomain.com"},on:{"set-tags":function(e){t.opt.exclude=e}}}),e("div",{staticClass:"description mt"},[t._v("*无需填写http(s)://协议头，仅填写主域名即可。如：yourdomain.com")])],1)]),t._e()])]):t._e(),e("a",{staticClass:"wb-btn-more",class:t.viewAllOption?"unfold":"",on:{click:function(e){t.viewAllOption=!t.viewAllOption}}},[e("svg",{staticClass:"wb-icon",attrs:{id:"arrow-down",viewBox:"0 0 32 32",width:"100%",height:"100%"}},[e("path",{attrs:{d:"M15.839 19.568h-.002a1.43 1.43 0 0 1-1.017-.423L.391 4.7c-.261-.262-.422-.622-.422-1.021s.161-.76.422-1.021a1.44 1.44 0 0 1 2.04 0l13.408 13.423L29.247 2.658a1.443 1.443 0 0 1 2.04 2.042L16.859 19.145c-.26.261-.62.423-1.018.423h-.002z"}}),e("path",{attrs:{d:"M15.839 29.75h-.002a1.43 1.43 0 0 1-1.017-.423L.391 14.882c-.261-.262-.422-.622-.422-1.021s.161-.76.422-1.021a1.44 1.44 0 0 1 2.04 0l13.408 13.423L29.247 12.84a1.443 1.443 0 0 1 2.04 2.042L16.859 29.327c-.26.261-.62.423-1.018.423h-.002z"}})]),e("span",[t._v(t._s(t.viewAllOption?"收起":"展开")+"更多选项")])]),t._m(1),t.isLoaded?e("div",{staticClass:"log-box"},[e("div",{staticClass:"tab-nav",attrs:{id:"broken_url_type"}},[e("a",{staticClass:"tn-item",class:{current:0==t.type},on:{click:function(e){return t.switch_tab(0)}}},[t._v("全部 ("+t._s(t.total)+")")]),e("a",{staticClass:"tn-item",class:{current:1==t.type},on:{click:function(e){return t.switch_tab(1)}}},[t._v("异常 ("+t._s(t.broken_url_sum["error"])+")")]),e("a",{staticClass:"tn-item",class:{current:2==t.type},on:{click:function(e){return t.switch_tab(2)}}},[t._v("重定向 ("+t._s(t.broken_url_sum["redirect"])+")")]),e("a",{staticClass:"tn-item",class:{current:4==t.type},on:{click:function(e){return t.switch_tab(4)}}},[t._v("待检测 ("+t._s(t.broken_url_sum["check"])+")")])]),e("el-table",{staticClass:"wbs-table mt",staticStyle:{width:"100%"},attrs:{data:t.broken_url},on:{"selection-change":t.handle_selection_change}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{label:"文章","class-name":"w60"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{attrs:{"data-label":"文章"}},[e("span",[t._v(t._s(a.row.post_title))])]),e("a",{staticClass:"url",attrs:{"data-label":"URL",href:a.row.url,target:"_blank"}},[t._v(t._s(a.row.url))])]}}],null,!1,596326088)}),e("el-table-column",{attrs:{label:"状态","class-name":"w10"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{attrs:{"data-label":"状态"}},[e("span",[t._v(t._s(a.row.code))])])]}}],null,!1,3912049159)}),e("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{plain:"",size:"mini",type:"success"},on:{click:function(e){return t.check_broken(a.row)}}},[t._v("重查")]),e("el-button",{attrs:{size:"mini",type:"info",plain:""},on:{click:function(e){return t.edit_post(a.row.edit_url)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(e){return t.remove_broken(a.row,a.$index)}}},[t._v("移除")]),/^(4|5|e)/.test(a.row.code)?e("el-button",{attrs:{size:"mini",type:"success",plain:""},on:{click:function(e){return t.mark_broken_url(a.row)}}},[t._v("未失效")]):t._e()]}}],null,!1,470301404)})],1),e("table",{staticClass:"table wbs-table mt"},[t.total>0?e("tfoot",{attrs:{id:"broken_footer"}},[e("tr",[e("td",[e("el-select",{attrs:{size:"small",placeholder:"批量操作"},model:{value:t.batch_op,callback:function(e){t.batch_op=e},expression:"batch_op"}},[e("el-option",{attrs:{label:"批量重新检测",value:"update"}}),e("el-option",{attrs:{label:"批量移除链接",value:"cancel"}}),e("el-option",{attrs:{label:"批量标记未失效",value:"ok"}})],1),e("el-button",{staticClass:"ml-s",attrs:{type:"info",plain:"",size:"small"},on:{click:t.batch_apply}},[t._v("应用")])],1),e("td",{staticClass:"align-right"},[e("button",{staticClass:"button-primary",attrs:{type:"button"},on:{click:t.clear_broken_url}},[t._v("重新检测")])])])]):t._e()]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.broken_url.length>0,expression:"broken_url.length > 0"}],staticClass:"btns-bar"},[e("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","page-size":1*t.page_num,total:1*t.record_total},on:{"current-change":t.nav_page}})],1)],1):t._e(),e("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),t.$cnf.is_pro?t._e():e("wbs-more-sources",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}]}),e("wbs-ctrl-bar",{on:{submit:t.updateData}})],1)},o=[function(){var t=this,e=t._self._c;return e("h3",{staticClass:"func-name"},[e("strong",[t._v("失效URL检测")])])},function(){var t=this,e=t._self._c;return e("h3",{staticClass:"sc-title-sub"},[e("span",[t._v("失效URL")])])}],n=a("8856"),i={name:"UrlBroken",components:{"wbs-custom-links":n["a"]},data(){const t=this;return{formChanged:0,isLoaded:!1,is_pro:t.$cnf.is_pro,opt:{},cnf:{},type:0,offset:0,page:1,page_num:20,record_total:0,post_statuses:[],post_types:[],broken_url:[],total:0,broken_url_sum:{ok:0,error:0,redirect:0,check:0},batch_op:"",multipleSelection:[],viewAllOption:0,tabTypeCctiveName:"url_type"}},created(){const t=this;t.getData(),t.load_data()},methods:{getData(){const t=this;t.$api.getData({action:t.$cnf.action.act,op:"get_options",key:"url_broken"}).then(e=>{t.opt=e.data.opt,t.cnf=e.data.cnf,t.total=e.data.total,t.post_types=e.data.post_types,t.post_statuses=e.data.post_statuses,t.broken_url_sum=e.data.broken_url_sum,t.isLoaded=!0})},load_data(){const t=this;t.$api.fetchData({action:t.$cnf.action.act,op:"broken_url",page:t.page,offset:t.offset,type:t.type}).then(e=>{t.broken_url=e.data,t.record_total=e.record_total,t.page_num=e.page_num})},updateData(t){const e=this;e.$api.saveData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:e.$cnf.action.act,op:"update_options",opt:e.opt,key:"broken"}).then(a=>{e.$wbui.toast("设置保存成功"),e.formChanged=1,t&&t()})},nav_page(t){this.page=t,this.load_data()},switch_tab(t){const e=this;e.type=t,e.page=1,e.load_data()},handle_selection_change(t){this.multipleSelection=t},edit_post(t){window.open(t)},batch_apply(){const t=this;if(!t.batch_op)return!1;if(t.multipleSelection.length<1)return t.$wbui.toast("未选择项目"),!1;let e=[];if(t.multipleSelection.forEach((function(t){e.push(t.id)})),!(e.length<1))if("ok"==t.batch_op)t.$wbui.confirm("所选链接确认设置为未失效？",()=>{let a=t.$wbui.toast("执行中...",{time:180});t.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:t.$cnf.action.act,op:"broken_url_batch",type:"ok",ids:e.join(",")}).then(e=>{t.$wbui.close(a),t.$wbui.toast("设置成功"),t.page=1,t.load_data()})});else if("update"==t.batch_op){let a=t.$wbui.toast("检测中...",{time:180});t.$wbui.confirm("确认重查所选链接？",()=>{t.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:t.$cnf.action.act,op:"broken_url_batch",type:"update",ids:e.join(",")}).then(e=>{t.$wbui.close(a),t.$wbui.toast("检测完毕"),t.load_data()})})}else if("cancel"==t.batch_op){let a=t.$wbui.toast("更新中...",{time:180});t.$wbui.confirm("确认移除所选链接？",()=>{t.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:t.$cnf.action.act,op:"broken_url_batch",type:"cancel",ids:e.join(",")}).then(e=>{t.$wbui.close(a),t.$wbui.toast("更新完毕"),t.load_data()})})}},clear_broken_url(){const t=this;return t.$wbui.confirm("确认重新检测所有URL？在下一检测周期检测所有URL。",()=>{t.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:"wb_smart_seo_tool",op:"clear_broken_url"}).then(e=>{t.$wbui.toast("URL状态重置成功，检测任务提交成功。"),t.page=1,t.load_data()})}),!1},mark_broken_url(t){const e=this;return e.$wbui.confirm("确认标记为未失效？",()=>{e.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:"wb_smart_seo_tool",op:"mark_broken_url",id:t.id}).then(t=>{e.$wbui.toast("标记成功"),e.load_data()})}),!1},remove_broken(t,e){const a=this;return a.$wbui.confirm("确认删除？",()=>{a.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:"wb_smart_seo_tool",op:"remove_broken",id:t.id}).then(t=>{a.broken_url.splice(e,1),a.$wbui.toast("已移除")})}),!1},check_broken(t){const e=this;return e.$api.getData({_ajax_nonce:_wb_sst_ajax_nonce||"",action:"wb_smart_seo_tool",op:"check_broken",id:t.id}).then(a=>{t.code=a.data,e.$wbui&&e.$wbui.toast("检测结果为["+a.data+"]"),e.load_data()}),!1}},watch:{opt:{handler(){this.formChanged++},deep:!0}},beforeRouteLeave(t,e,a){const s=this;s.formChanged>2?s.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return a(!1),s.updateData(()=>{a()}),!1},no(){return a(),!1}}):a()}},l=i,c=a("2877"),r=Object(c["a"])(l,s,o,!1,null,null,null);e["default"]=r.exports},8856:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wbs-custom-links"},[e("label",{staticClass:"wb-links-input-box"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.cur_input,expression:"cur_input"}],staticClass:"wbs-input wbs-input-short",attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.cur_input},on:{keyup:t.wbTagInput,input:function(e){e.target.composing||(t.cur_input=e.target.value)}}}),e("a",{staticClass:"ml link",on:{click:t.wbTagPush}},[t._v("添加 +")])]),t.items.length?e("div",{staticClass:"links-items"},t._l(t.items,(function(a,s){return e("div",{key:s,staticClass:"link-item"},[e("span",{staticClass:"item-value",domProps:{innerHTML:t._s(t.displayFormat(a))}}),e("span",{staticClass:"del",attrs:{"data-del-val":a},on:{click:function(e){return t.delItem(s)}}},[e("i",{staticClass:"el-icon-delete"})])])})),0):t._e()])},o=[],n={name:"comCustomLinks",props:{items:Array,mode:Number,placeholder:String},data(){return{cur_input:"",taglist:[],keycode:null}},created(){this.taglist=this.items?this.items:[]},methods:{wbTagInput(t){var e=this,a=t.keyCode;188===a&&(e.cur_input=e.cur_input.replace(/(^,)|(,$)/,"")),13===a&&(e.wbTagPush(),event.stopPropagation())},wbTagPush(t){var e=this;return""!=e.cur_input&&(e.taglist.indexOf(e.cur_input.trim())>-1?(e.$wbui.toast("已存在"),e.cur_input="",!1):(e.taglist.push(e.cur_input),e.$emit("set-tags",e.taglist),e.cur_input="",!1))},delItem(t){var e=this;e.$wbui.confirm("确认删除？",()=>{e.taglist.splice(t,1),e.$emit("set-tags",e.taglist),e.$wbui.toast("已移除")})},displayFormat(t){return t}}},i=n,l=a("2877"),c=Object(l["a"])(i,s,o,!1,null,null,null);e["a"]=c.exports}}]);